<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
declare(strict_types=1);

use Magento\Framework\Escaper;
use Magento\Framework\View\Helper\SecureHtmlRenderer;

/** @var Escaper $escaper */
/** @var SecureHtmlRenderer $secureRenderer */
$type = $element->getType();
$htmlId = $element->getHtmlId();
?>
<?php if ($type === 'fieldset'): ?>
    <fieldset>
        <legend><?= $escaper->escapeHtml($element->getLegend()); ?></legend>
        <br/>

        <?php foreach ($element->getElements() as $_element): ?>
            <?= /* @noEscape */ $formBlock->drawElement($_element); ?>
        <?php endforeach; ?>
    </fieldset>
<?php elseif ($type === 'hidden'): ?>
    <input type="<?= $escaper->escapeHtmlAttr($element->getType()); ?>"
           name="<?= $escaper->escapeHtmlAttr($element->getName()); ?>"
           id="<?= $escaper->escapeHtmlAttr($htmlId); ?>"
           value="<?= $escaper->escapeHtmlAttr($element->getValue()); ?>">
<?php elseif ($type === 'select'): ?>
    <span class="form_row">
        <?php if ($element->getLabel()): ?>
            <label for="<?= $escaper->escapeHtmlAttr($htmlId); ?>">
                <?= $escaper->escapeHtml($element->getLabel()); ?>:
            </label>
        <?php endif; ?>

        <select name="<?= $escaper->escapeHtmlAttr($element->getName()); ?>"
                id="<?= $escaper->escapeHtmlAttr($htmlId); ?>"
                class="select<?= $escaper->escapeHtmlAttr($element->getClass()); ?>"
                title="<?=  $escaper->escapeHtmlAttr($element->getTitle()); ?>">

            <?php foreach ($element->getValues() as $_value): ?>
                <option <?= /* @noEscape */ $_value->serialize(); ?>
                    <?php if ($_value->getValue() == $element->getValue()): ?>
                        selected="selected"
                    <?php endif; ?>>
                    <?= $escaper->escapeHtml($_value->getLabel()); ?>
                </option>
            <?php endforeach; ?>
        </select>
    </span>
<?php elseif ($type === 'text' || $type === 'button' || $type === 'password'): ?>
    <span class="form_row">
        <?php if ($element->getLabel()): ?>
            <label for="<?= /* @noEscape */ $htmlId ?>" <?= /* @noEscape */ $block->getUiId('label'); ?>>
                <?= $escaper->escapeHtml($element->getLabel()); ?>:
            </label>
        <?php endif; ?>

        <input type="<?= $escaper->escapeHtmlAttr($element->getType()); ?>"
               name="<?= $escaper->escapeHtmlAttr($element->getName()); ?>"
               id="<?= $escaper->escapeHtmlAttr($htmlId); ?>"
               value="<?= $escaper->escapeHtmlAttr($element->getValue()); ?>"
               class="input-text <?= $escaper->escapeHtmlAttr($element->getClass()); ?>"
               title="<?= $escaper->escapeHtmlAttr($element->getTitle()); ?>"/>
        <?php if ($listener = $element->getOnclick()): ?>
            <?= /* @noEscape */ $secureRenderer->renderEventListenerAsTag('onclick', $listener, "#{$htmlId}"); ?>
        <?php endif; ?>
    </span>
<?php elseif ($type === 'radio'): ?>
    <span class="form_row">
        <?php if ($element->getLabel()): ?>
            <label for="<?= $escaper->escapeHtmlAttr($htmlId); ?>">
                <?= $escaper->escapeHtml($element->getLabel()); ?>:
            </label>
        <?php endif; ?>

        <input type="<?= $escaper->escapeHtmlAttr($element->getType()); ?>"
               name="<?= $escaper->escapeHtmlAttr($element->getName()); ?>"
               id="<?= $escaper->escapeHtmlAttr($htmlId); ?>"
               value="<?= $escaper->escapeHtmlAttr($element->getValue()); ?>"
               class="input-text <?= $escaper->escapeHtmlAttr($element->getClass()); ?>"
               title="<?= $escaper->escapeHtmlAttr($element->getTitle()); ?>"/>
    </span>
<?php elseif ($type === 'radios'): ?>
    <span class="form_row">
        <label for="<?= $escaper->escapeHtmlAttr($htmlId); ?>">
            <?= $escaper->escapeHtml($element->getLabel()); ?>:
        </label>

        <?php foreach ($element->getRadios() as $_radio): ?>
            <input type="radio"
                   name="<?=  $escaper->escapeHtmlAttr($_radio->getName()); ?>"
                   id="<?= $escaper->escapeHtmlAttr($_radio->getHtmlId()); ?>"
                   value="<?=  $escaper->escapeHtmlAttr($_radio->getValue()); ?>"
                   class="input-radio <?= $escaper->escapeHtmlAttr($_radio->getClass()); ?>"
                   title="<?=  $escaper->escapeHtmlAttr($_radio->getTitle()); ?>"
                   <?= $_radio->getValue() === $element->getChecked() ? 'checked="true"' : ''; ?>>
                <?= $escaper->escapeHtml($_radio->getLabel()); ?>
        <?php endforeach; ?>
    </span>
<?php elseif ($type === 'wysiwyg'): ?>
    <span class="form_row">
        <label for="<?= $escaper->escapeHtmlAttr($htmlId); ?>">
            <?= $escaper->escapeHtml($element->getLabel()); ?>:
        </label>

        <?php $scriptString = <<<script
        require([
            "wysiwygAdapter"
        ], function(tinyMCE){
            tinyMCE.init({
                mode : "exact",
                theme : "advanced",
                elements : "{$escaper->escapeJs($element->getName())}",
                plugins : "inlinepopups,style,layer,table,save,advhr,advimage,advlink,emotions,iespell,"
                    + "insertdatetime,preview,zoom,media,searchreplace,print,paste,directionality,"
                    + "fullscreen,noneditable,visualchars,nonbreaking,xhtmlxtras",
                theme_advanced_buttons1 : "newdocument,|,bold,italic,underline,strikethrough,|"
                    + ",justifyleft,justifycenter,justifyright,justifyfull,|"
                    + ",styleselect,formatselect,fontselect,fontsizeselect",
                theme_advanced_buttons2 : "cut,copy,paste,pastetext,pasteword,|,search,replace,|,bullist,numlist,|"
                    + ",outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code,|"
                    + ",insertdate,inserttime,preview,|,forecolor,backcolor",
                theme_advanced_buttons3 : "tablecontrols,|,hr,removeformat,visualaid,|,sub,sup,|"
                    + ",charmap,emotions,iespell,media,advhr,|,print,|,ltr,rtl,|,fullscreen",
                theme_advanced_buttons4 : "insertlayer,moveforward,movebackward,absolute,|,styleprops,|"
                    + ",cite,abbr,acronym,del,ins,|,visualchars,nonbreaking",
                theme_advanced_toolbar_location : "top",
                theme_advanced_toolbar_align : "left",
                theme_advanced_path_location : "bottom",
                extended_valid_elements : "a[name|href|target|title|onclick],img[class|src|border=0|alt|title|hspace"
                    + "|vspace|width|height|align|onmouseover|onmouseout|name],hr[class|width|size"
                    + "|noshade],font[face|size|color|style],span[class|align|style]",
                theme_advanced_resize_horizontal : 'false',
                theme_advanced_resizing : 'true',
                apply_source_formatting : 'true',
                convert_urls : 'false',
                force_br_newlines : 'true',
                doctype : '<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"'
                    + ' "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'
            });
        });
script; ?>

        <?= /* @noEscape */ $secureRenderer->renderTag('script', [], $scriptString, false); ?>

        <textarea name="<?= $escaper->escapeHtmlAttr($element->getName()); ?>"
                  title="<?= $escaper->escapeHtmlAttr($element->getTitle()); ?>"
                  id="<?= $escaper->escapeHtmlAttr($htmlId); ?>"
                  class="textarea <?= $escaper->escapeHtmlAttr($element->getClass()); ?>"
                  cols="80"
                  rows="20">
            <?= $escaper->escapeHtml($element->getValue()); ?>
        </textarea>
    </span>
<?php elseif ($type === 'textarea'): ?>
    <span class="form_row">
        <label for="<?= $escaper->escapeHtmlAttr($htmlId); ?>">
            <?= $escaper->escapeHtml($element->getLabel()); ?>:
        </label>
        <textarea name="<?= $escaper->escapeHtmlAttr($element->getName()); ?>"
                  title="<?= $escaper->escapeHtmlAttr($element->getTitle()); ?>"
                  id="<?= $escaper->escapeHtmlAttr($htmlId); ?>"
                  class="textarea <?= $escaper->escapeHtmlAttr($element->getClass()); ?>"
                  cols="15"
                  rows="2">
            <?= $escaper->escapeHtml($element->getValue()); ?>
        </textarea>
    </span>
<?php endif; ?>

<?php if ($element->getScript()): ?>
    <?php /* @noEscape */ $secureRenderer->renderTag('script', [], $element->getScript(), false); ?>
<?php endif; ?>
